<!DOCTYPE html>
<html>
    <head>
        <title>resource</title>
    </head>
    <body>
        <canvas id = "canvas" width = "480" height = "1500"></canvas>
        <script>
            const context=document.getElementById("canvas").getContext("2d");
            context.fillStyle = "white";
            context.clearRect(0,0,480,1500);
            let t = 0;
            let size = 20;
            let mode = 0;
            for(let y = 50;y < 1500;y += 100)
            {
                for(let x = 20;x < 480;x += 40)
                {
                    let deg = 0;
                    let l = 0;
                    if(mode === 0)
                    {
                        deg = Math.PI*(60-t)/80;
                        if(t === 60-1)
                        {
                            mode = 1;
                            t = -1;
                        }
                    }
                    else if(mode === 1)
                    {
                        l = size*t/120;
                        if(t === 60-1)
                        {
                            t = -1;
                            mode = 2;
                        }
                    }
                    else
                    {
                        l = size/2;
                    }
                    //if(mode == 2 && t > 30)break;
                    context.strokeStyle = "black";
                    {
                        context.fillStyle = "black";
                        const deg0 = Math.PI/2;
                        const p0 = { x: x + size * Math.cos(deg0), y: y + size * Math.sin(deg0) };
                        const p1 = { x: x + (size + l) * Math.cos(deg0), y: y + (size + l) * Math.sin(deg0) };
                        let p2 = { x: p1.x + size * Math.cos(deg0 + deg), y: p1.y + size * Math.sin(deg0 + deg) };
                        let p3 = { x: p1.x + size / Math.sqrt(2) * Math.cos(deg0 + deg + Math.PI / 4), y: p1.y + size / Math.sqrt(2) * Math.sin(deg0 + deg + Math.PI / 4) };
                        context.beginPath();
                        context.moveTo(p1.x, p1.y);
                        context.lineTo(p2.x, p2.y);
                        context.lineTo(p3.x, p3.y);
                        context.fill();
                        p2 = { x: p1.x + size * Math.cos(deg0 - deg), y: p1.y + size * Math.sin(deg0 - deg) };
                        p3 = { x: p1.x + size / Math.sqrt(2) * Math.cos(deg0 - + deg - Math.PI / 4), y: p1.y + size / Math.sqrt(2) * Math.sin(deg0 - deg - Math.PI / 4) };
                        context.beginPath();
                        context.moveTo(p1.x, p1.y);
                        context.lineTo(p2.x, p2.y);
                        context.lineTo(p3.x, p3.y);
                        context.fill();
                        context.beginPath();
                        context.moveTo(p0.x, p0.y);
                        context.lineTo(p1.x, p1.y);
                        context.stroke();
                        const sc = { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 };
                        if (mode >= 2) {
                            const square = t < 60 ? t / 120 * size : size / 4;
                            const sd = (square - size / 8) * 2 * Math.PI / size;
                            context.beginPath();
                            context.moveTo(sc.x + square * Math.cos(deg0 + sd), sc.y + square * Math.sin(deg0 + sd));
                            for (let i = 1; i < 4; i++)context.lineTo(sc.x + square * Math.cos(deg0 + sd + Math.PI / 2 * i), sc.y + square * Math.sin(deg0 + sd + Math.PI / 2 * i));
                            context.fillStyle = "white";
                            context.fill();
                            const q0 = {x:sc.x+size/2,y:sc.y       };
                            const q1 = {x:sc.x       ,y:sc.y+size/2};
                            const q2 = {x:sc.x-size/2,y:sc.y       };
                            const q3 = {x:sc.x       ,y:sc.y-size/2};
                            context.beginPath();
                            context.moveTo(q0.x,q0.y);
                            context.lineTo(q1.x,q1.y);
                            context.lineTo(q2.x,q2.y);
                            context.lineTo(q3.x,q3.y);
                            context.lineTo(q0.x,q0.y);
                            context.stroke();                 
                        }
                    }
                    {
                        context.fillStyle = "black";
                        const deg0 = -Math.PI/2;
                        const p0 = { x: x + size * Math.cos(deg0), y: y + size * Math.sin(deg0) };
                        const p1 = { x: x + (size + l) * Math.cos(deg0), y: y + (size + l) * Math.sin(deg0) };
                        let p2 = { x: p1.x + size * Math.cos(deg0 + deg), y: p1.y + size * Math.sin(deg0 + deg) };
                        let p3 = { x: p1.x + size / Math.sqrt(2) * Math.cos(deg0 + deg + Math.PI / 4), y: p1.y + size / Math.sqrt(2) * Math.sin(deg0 + deg + Math.PI / 4) };
                        context.beginPath();
                        context.moveTo(p1.x, p1.y);
                        context.lineTo(p2.x, p2.y);
                        context.lineTo(p3.x, p3.y);
                        context.fill();
                        p2 = { x: p1.x + size * Math.cos(deg0 - deg), y: p1.y + size * Math.sin(deg0 - deg) };
                        p3 = { x: p1.x + size / Math.sqrt(2) * Math.cos(deg0 - + deg - Math.PI / 4), y: p1.y + size / Math.sqrt(2) * Math.sin(deg0 - deg - Math.PI / 4) };
                        context.beginPath();
                        context.moveTo(p1.x, p1.y);
                        context.lineTo(p2.x, p2.y);
                        context.lineTo(p3.x, p3.y);
                        context.fill();
                        context.beginPath();
                        context.moveTo(p0.x, p0.y);
                        context.lineTo(p1.x, p1.y);
                        context.stroke();
                        const sc = { x: (p1.x + p2.x) / 2, y: (p1.y + p2.y) / 2 };
                        if (mode >= 2) {
                            const square = t < 60 ? t / 120 * size : size / 4;
                            const sd = (square - size / 8) * 2 * Math.PI / size;
                            context.beginPath();
                            context.moveTo(sc.x + square * Math.cos(deg0 + sd), sc.y + square * Math.sin(deg0 + sd));
                            for (let i = 1; i < 4; i++)context.lineTo(sc.x + square * Math.cos(deg0 + sd + Math.PI / 2 * i), sc.y + square * Math.sin(deg0 + sd + Math.PI / 2 * i));
                            context.fillStyle = "white";
                            context.fill();
                            const q0 = {x:sc.x+size/2,y:sc.y       };
                            const q1 = {x:sc.x       ,y:sc.y+size/2};
                            const q2 = {x:sc.x-size/2,y:sc.y       };
                            const q3 = {x:sc.x       ,y:sc.y-size/2};
                            context.beginPath();
                            context.moveTo(q0.x,q0.y);
                            context.lineTo(q1.x,q1.y);
                            context.lineTo(q2.x,q2.y);
                            context.lineTo(q3.x,q3.y);
                            context.lineTo(q0.x,q0.y);
                            context.stroke();                 
                        }
                    }
                    {
                        context.fillStyle = "black";
                        let px = new Array(6);
                        let py = new Array(6);
                        for (let i = 0;i < 6;i++)
                        {
                            px[i] = x + size * Math.cos(Math.PI / 2 * i);
                            py[i] = y + size * Math.sin(Math.PI / 2 * i);
                        }
                        for (let i = 1; i < 5; i++) {
                            context.beginPath();
                            context.moveTo(px[i], py[i]);
                            context.lineTo((px[i]+px[i+1])/2,(py[i]+py[i+1])/2);
                            context.lineTo((px[i]+px[i-1])/2,(py[i]+py[i-1])/2);
                            context.closePath();
                            context.fill();
                        }
                        context.beginPath();
                        context.moveTo((px[1]+px[2])/2,(py[1]+py[2])/2);
                        context.lineTo((px[2]+px[3])/2,(py[2]+py[3])/2);
                        context.lineTo((px[3]+px[4])/2,(py[3]+py[4])/2);
                        context.lineTo((px[4]+px[5])/2,(py[4]+py[5])/2);
                        context.fillStyle = "white";
                        context.fill();
                        //あたり判定枠
                        context.beginPath();
                        context.arc(x, y, 1, Math.PI * 2, false);
                        context.closePath();
                        context.fillStyle = "black";
                        context.fill();
                    }
                    t++;
                }
            }
        </script>
    </body>
</html>